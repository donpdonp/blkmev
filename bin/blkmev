#!/usr/bin/env perl6

use v6;
use lib './lib';
use BlkMeV;
use BlkMeV::Net;

sub MAIN ( Str $chain_name =  "bitcoin", Str $seed_host = "" ) {

  my $chain = BlkMeV::Chain::Chain.new(name => $chain_name);
  my $master_switch = Channel.new;
  my @mempool;
  my $host = $seed_host.chars > 0 ?? $seed_host !! $chain.host;

  Net::client(@mempool, $chain, $host, $master_switch);
#  my $chain2 = BlkMeV::Chain::Chain.new(name => $chain_name);
#  client(@mempool, $chain2, "218.75.140.48", $master_switch);

  $master_switch.receive; # wait forever
}

=begin pod
=head1 USAGE
$ blkmev
=end pod

